---
title: Convert timing channel detection method based on time interval and payload length analysis
date: 2022-12-29 12:56:05
tags: 隐蔽信道
---

今天分享的论文的主题是基于时间间隔和载荷长度分析的时序型隐蔽信道检测方法，研究团队来自于四川大学和国防科技大学。该论文对目前主流的5种时序型网络隐蔽信道进行分析，并提出了一种基于k近邻（k-NN）算法的隐蔽时间信道检测方法。该方法利用一系列与时间间隔和载荷长度相关的统计量作为特征来训练机器学习模型，并使用10折交叉验证来提高模型性能。实验结果表明，该模型具有很好的检测效果，检测准确率为96%，AUC值为0.9737。该论文发表于2020年Computers & Security（CCF推荐B类国际学术期刊）。

{% asset_img fig1.jpg %}



# **01**

# **背景介绍**

当今的网络防御策略变得越来越严格，攻击者很难在不被网络安全设备检测到的情况下窃取信息。因此如何从系统中窃取信息是攻击者研究的热点。在众多信息窃取手段中，有一种手段隐蔽性极高：攻击者通过在目标服务器上植入隐蔽通道程序并控制服务器和攻击者主机之间交换的数据包来实现秘密通信。



由于隐蔽通信是通过看似正常的交互来实现的，许多网络安全设备很难对其进行检测，因此隐蔽信道检测一直是研究的热点。通常，研究人员将隐蔽信道分为存储隐蔽信道和时序隐蔽信道。存储型隐蔽信道使用数据传输协议中的有效载荷或非有效载荷字段来隐藏秘密信息并实现隐蔽通信。时序隐蔽信道利用数据包之间的时间间隔对秘密信息进行编码，实现隐蔽通信。



目前，有很多有用的时序隐蔽信道检测方法，但这些方法只能检测特定类型的时序隐蔽信道。论文的主要贡献便是提出了一种时序隐蔽信道检测方法，对通信数据包执行过滤、分组和其他操作。在此基础上，选择合适的机器学习算法对分类模型进行训练。并基于对5大主流时序隐蔽信道的分析实验，评估了检测方法的有效性。



# **02**

# **研究方法**



## **1** **系统框架**

**数据生成：**捕获正常通信和隐蔽通信中的数据包，将通信包发送到数据处理模块。在数据处理模块中，过滤不合适的数据包，将合适的数据包发送到数据包处理子模块进行处理。在数据包处理子模块中，将所有数据包按照〈src，dst，sport，dport，proto〉进行分组，每组数据包按照源IP地址分为上行数据包和下行数据包。下一个子模块是特征提取。在特征提取子模块中，将基于进展的分组来提取特征。之后对每一个特征数据进行了标注，并进行人工检查，以确保标注的正确性。由此，生成实验所需的训练数据。



**模型生成：**选择四种分类算法（k-NN，贝叶斯算法，SVM，逻辑回归）对训练数据进行四个模型的训练，然后使用10倍交叉验证来提高这些模型的性能。之后对这四种模型进行评估，并选择性能最好的模型作为时序隐蔽信道检测模型。



**检测：**检测模型将确定在输入的.pcap文件中是否存在秘密通信



{% asset_img fig2.jpg %}



## **2** **特征提取**



文章发现：以牺牲服务器作为参考，上行链路分组的数量通常大于或等于下行链路分组的数量。因此将分组后的数据包分为上行数据包和下行数据包，并在此基础上进行特征提取。



2.1 对于时序隐蔽信道，攻击者传输的信息是由包间隔时延编码的，因此文章认为包间隔时延存在一些特定的统计规律。因此计算了这些包间隔时延的平均值、方差和熵。

2.2由于攻击者会控制数据包的发送时间，这些数据包的发送速度也不同于正常通信。因此考虑计算发送分组的速度。

2.3 与正常通信不同，由于攻击者使用时序隐蔽信道传输的数据容量较小，因此隐蔽通信的分组的数量少于正常通信。这个特性使文章相信数据包的数量可以是一个很大的特性。

2.4 此外，文章还发现一些攻击者会通过重放正常的数据包来实现时序隐蔽信道;而其它攻击者将通过构造分组来实现它。对于这些构造数据包的攻击者来说，他们构造的数据包的有效负载很可能只是一个随机生成的字符串。而且，在隐蔽通信过程中，需要尽可能避免分片，因此这些有效载荷的长度会固定在一个范围内。因此文章猜测，可以使用一系列与有效载荷相关的统计特征来检测时序隐蔽信道。提取的特征如表1所示

{% asset_img fig3.jpg %}





## **3** **分类算法**

判断通信中是否存在隐蔽通信是一个二元分类问题，因此我们重点研究了用于分类的机器学习算法。我们分别选择了k-NN算法、贝叶斯算法、SVM算法和逻辑回归算法来训练模型。最后，根据模型的检测性能选择了k-NN算法。如图2所示。绿色菱形代表秘密通讯样本。红色矩形表示正常通信样本。白色三角形表示要预测的样本。我们为k设置一个值;根据k，有三个正常通信样本和两个隐蔽通信样本最接近待预测样本。因此，待预测样本的类别为正常通信。

{% asset_img fig4.jpg %}



# **03**

# **实验**

## **1** **实验拓扑**

{% asset_img fig5.jpg %}



## **2** **隐蔽信道类型**

{% asset_img fig6.jpg %}

{% asset_img fig7.jpg %}

{% asset_img fig8.jpg %}

{% asset_img fig9.jpg %}

{% asset_img fig10.jpg %}

## **3** **数据集**

数据集的结构如表2所示。对于正常通信，捕获了320022个分组;对于秘密通信，截获了113497个数据包。根据提取的特征结构，对这些数据包进行处理，形成训练数据。在训练数据中，标记为隐蔽通信的数据为1923个，标记为正常通信的数据为1704个。

{% asset_img fig11.jpg %}



## **4** **模型生成**



### **4.1 交叉验证**

文章总结了以往机器学习的相关论文，发现如果只将数据集按照一定的比例分为训练数据和测试数据；使用训练数据来训练模型以及使用测试数据来测试模型，则模型可能是过拟合的。

因此，文章采用10倍交叉验证方法对模型进行训练和评估，以防止模型过拟合。实验的10重交叉验证结构如图9所示。共分三个部分：数据分割、评估和最终结果。首先，我们使用Python中scikitlearn库的StratifiedKFold类将训练数据划分为十个相似的子集。然后将分割数据发送至评估。在评估中训练模型十次。对于每次训练，将选择9个子集作为训练集，剩余的集将用作验证集。所以有十个结果。最后，根据这十个结果计算最终的评估结果。

{% asset_img fig12.jpg %}



### **4.2 **性能评估

文章选用召回率、检测精度、F1-score和AUC指数来评价检测方法的好坏。

{% asset_img fig13.jpg %}

召回率是所有被正确分类为隐蔽通信的样本与所有隐蔽通信样本的比率。

检测精度是被正确分类为隐蔽通信的所有样本与被预测为隐蔽通信的所有样本的比率。

F1是查全率和查准率的综合度量。

AUC指数是ROC曲线的面积，可以评价分类模型的整体效果。

{% asset_img fig14.jpg %}

{% asset_img fig15.jpg %}

# **04**

# **总结**

时序隐蔽信道是最臭名昭著的信息窃取方法之一。虽然目前已有不少关于时序隐蔽信道检测的研究，但这些方法只能有效地检测出特定类型的时间隐通道。为了克服这些方法的不足，文章提出了一种基于kNN算法的隐蔽时间信道检测方法，该方法可以达到较好的检测性能，但从长远来看，攻击者已经开始研究如何避免对隐蔽时间信道的统计分析。显然，文章中提取的用于隐蔽定时信道检测的特征在未来将失效。
